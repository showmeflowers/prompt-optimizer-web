<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>Prompt ä¼˜åŒ–å™¨</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f7fa;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
    }

    .container {
      max-width: 800px;
      width: 100%;
      background: #fff;
      margin: 40px 20px;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
    }

    h2 {
      text-align: center;
      color: #333;
      margin-bottom: 20px;
    }

    label {
      font-weight: bold;
      display: block;
      margin-top: 15px;
      margin-bottom: 6px;
      color: #444;
    }

    textarea, input {
      width: 100%;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-bottom: 10px;
      font-size: 14px;
      resize: vertical;
      box-sizing: border-box;
    }

    textarea {
      height: 120px;
    }

    .btn {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      margin-top: 10px;
      transition: 0.2s;
    }

    .btn-primary {
      background: #4CAF50;
      color: #fff;
    }

    .btn-primary:hover {
      background: #45a049;
    }

    .btn-secondary {
      background: #0078D7;
      color: #fff;
    }

    .btn-secondary:hover {
      background: #005A9E;
    }

    #result {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #ddd;
      background: #fafafa;
      min-height: 120px;
      white-space: pre-wrap;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>âœ¨ Prompt ä¼˜åŒ–å™¨</h2>

    <label>è¾“å…¥ä½ çš„ DeepSeek API Key:</label>
    <input type="password" id="apiKey" placeholder="sk-xxxx">
    <button class="btn btn-secondary" onclick="window.open('https://platform.deepseek.com/usage', '_blank')">
      è¿˜æ²¡æœ‰ APIï¼Ÿç‚¹å‡»æé€Ÿç”³è¯·
    </button>

    <label>åŸå§‹ Prompt:</label>
    <textarea id="inputPrompt" placeholder="è¯·è¾“å…¥éœ€è¦ä¼˜åŒ–çš„æç¤ºè¯"></textarea>

    <label>ä¼˜åŒ–ç›®æ ‡ï¼ˆä¾‹å¦‚ï¼šæå‡ä¸“ä¸šæ€§ã€æå‡è‰ºæœ¯æ€§ï¼‰:</label>
    <input type="text" id="optGoal" placeholder="ä¾‹å¦‚ï¼šæå‡ä¸“ä¸šæ€§">

    <button class="btn btn-primary" onclick="optimizePrompt()">ğŸš€ ä¼˜åŒ–</button>

    <h3 style="margin-top:20px;color:#333;">ä¼˜åŒ–ç»“æœ:</h3>
    <div id="result"></div>
  </div>

  <script>
    async function optimizePrompt() {
      const apiKey = document.getElementById("apiKey").value.trim();
      const inputPrompt = document.getElementById("inputPrompt").value.trim();
      const optGoal = document.getElementById("optGoal").value.trim();
      const resultDiv = document.getElementById("result");

      if (!apiKey || !inputPrompt) {
        alert("è¯·è¾“å…¥ API Key å’ŒåŸå§‹ Promptï¼");
        return;
      }

      resultDiv.textContent = "æ­£åœ¨ä¼˜åŒ–ï¼Œè¯·ç¨å€™...";

      try {
        const response = await fetch("https://api.deepseek.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${apiKey}`
          },
          body: JSON.stringify({
            model: "deepseek-chat",
            messages: [
              { role: "system", content: "ä½ æ˜¯ä¸€ä¸ªæç¤ºè¯ä¼˜åŒ–åŠ©æ‰‹ï¼Œåªè¾“å‡ºä¼˜åŒ–åçš„ Promptï¼Œä¸è¦ä»»ä½•è§£é‡Šæˆ–é¢å¤–è¯´æ˜ã€‚" },
              { role: "user", content: `ä¼˜åŒ–ç›®æ ‡: ${optGoal}\nåŸå§‹ prompt: ${inputPrompt}` }
            ]
          })
        });

        if (!response.ok) {
          throw new Error("API è¯·æ±‚å¤±è´¥: " + response.status);
        }

        const data = await response.json();
        let optimizedRaw = data.choices[0].message.content;
        let optimized = optimizedRaw;

        // è‡ªåŠ¨æå–ä¼˜åŒ–åçš„ Promptï¼ˆå¦‚æœè¿”å›é‡Œæœ‰â€œä»¥ä¸‹æ˜¯ä¼˜åŒ–åçš„ promptâ€ï¼‰
        const marker = "ä»¥ä¸‹æ˜¯ä¼˜åŒ–åçš„ prompt";
        if (optimizedRaw.includes(marker)) {
          optimized = optimizedRaw.split(marker)[1].trim();
        }

        resultDiv.textContent = optimized;
      } catch (error) {
        resultDiv.textContent = "å‡ºé”™å•¦: " + error.message;
      }
    }
  </script>
</body>
</html>
